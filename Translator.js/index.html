<!-- https://github.com/muaz-khan/WebRTC-Experiment/tree/master/Translator.js -->
<!DOCTYPE html>
<html lang="en">

    <head>
        <title>Translator.js / Voice & Text Translator ® Muaz Khan</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <link rel="author" type="text/html" href="https://plus.google.com/+MuazKhan">
        <meta name="author" content="Muaz Khan">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        
        <link rel="stylesheet" href="//cdn.webrtc-experiment.com/style.css">
        
        <script>
            document.createElement('article');
            document.createElement('footer');
        </script>
    
        <script src="//cdn.webrtc-experiment.com/firebase.js"> </script>
        <script src="//cdn.webrtc-experiment.com/Translator.js"> </script>
        
        <!-- scripts used for styling code -->
        <script src="//cdn.webrtc-experiment.com/syntax/sh_main.min.js" type="text/javascript"> </script>
        <script src="//cdn.webrtc-experiment.com/syntax/sh_javascript.min.js" type="text/javascript"> </script>
        <script src="//cdn.webrtc-experiment.com/syntax/sh_html.min.js" type="text/javascript"> </script>
        <link href="//cdn.webrtc-experiment.com/syntax/sh_style.css" type="text/css" rel="stylesheet">
    </head>

    <body onload="sh_highlightDocument();">
        <article>
    
            <header style="text-align: center;">

                <h1><a href="https://github.com/muaz-khan/WebRTC-Experiment/tree/master/Translator.js">Translator.js</a> / Voice & Text Translator ®  <a href="https://www.webrtc-experiment.com/">Muaz Khan</a></h1>            
                <p>
                    <a href="https://www.webrtc-experiment.com/">HOME</a>
                    <span> &copy; </span>
                    <a href="http://www.MuazKhan.com/" target="_blank">Muaz Khan</a>
                    
                    .
                    <a href="http://twitter.com/WebRTCWeb" target="_blank" title="Twitter profile for WebRTC Experiments">@WebRTCWeb</a>
                    
                    .
                    <a href="https://github.com/muaz-khan?tab=repositories" target="_blank" title="Github Profile">Github</a>
                    
                    .
                    <a href="https://github.com/muaz-khan/WebRTC-Experiment/issues?state=open" target="_blank">Latest issues</a>
                    
                    .
                    <a href="https://github.com/muaz-khan/WebRTC-Experiment/commits/master" target="_blank">What's New?</a>
                </p>
            </header>
            
            <div class="github-stargazers"></div>
        
            <section class="experiment">
                <h2 class="header" id="what">What is Translator.js?</h2>
                <p>
                    Translator.js is a JavaScript library built top on Google Speech-Recognition & Translation API to transcript and translate voice and text. It supports many locales and brings globalization in <a href="https://www.webrtc-experiment.com/">WebRTC</a>!
                </p>
            </section>
        
            <section class="experiment">
                <h2 class="header" id="test">Test among two computers or windows:</h2>
                <p>
                    <input type="checkbox" id="robot-voice" checked title="A client-side robot that can speak your voice in target language!">
                    <label for="robot-voice"><a href="//cdn.webrtc-experiment.com/Robot-Speaker.js">Robot</a> Voice?</label>

                    <select id="your-language" title="Auto translate remote voice into?">
                        <option>en (English)</option>
                        <option>ar (العربية)</option>
                        <option>de (Deutsch)</option>
                        <option>fr (Français)</option>
                        <option>hi (हिंदी)</option>
                        <option>pt (Português)</option>
                        <option>ru (Русский)</option>
                        <option>es (Español)</option>
                        <option>tr (Türk)</option>
                        <option>nl (Nederlands)</option>
                        <option>it (Italiano)</option>
                        <option>pl (Polski)</option>
                        <option>ro (Român)</option>
                        <option>sv (Svensk)</option>
                        <option>vi (Việt)</option>
                        <option>th (ภาษาไทย)</option>
                        <option>zh-CN (中文简体)</option>
                        <option>zh-TW (中國傳統)</option>
                        <option>ko (한국의)</option>
                        <option>ja (日本人)</option>
                        <option>el (ελληνικά)</option>
                        <option>ts (தமிழ்)</option>
                        <option>hy (հայերեն)</option>
                        <option>bs (Bosanski)</option>
                        <option>ca (Català)</option>
                        <option>hr (Hrvatski)</option>
                        <option>dq (Dansk)</option>
                        <option>eo (Esperanto)</option>
                        <option>fi (Suomalainen)</option>
                        <option>ht (Haian kreyòl)</option>
                        <option>hu (Magyar)</option>
                        <option>is (Icelandic)</option>
                        <option>id (Indonesia)</option>
                        <option>la (Latinum)</option>
                        <option>lv (Latvijas)</option>
                        <option>mk (Македонски)</option>
                        <option>no (Norsk)</option>
                        <option>sr (Српски)</option>
                        <option>sk (Slovenský)</option>
                        <option>sw (Kiswahili)</option>
                        <option>cy (Cymraeg)</option>
                    </select>

                    <button id="start-speaking" title="Speak in selected language.">Start Speaking</button>
                    
                    <p>
                        Do you want to open private room? Click <a href="/Translator/" target="_blank" title="Open this link in new tab. Then your room will be private!"><code><strong id="unique-token">#123456789</strong></code></a> and open resulting URL between two tabs or windows.
                    </p>
            
                    <ol id="logs"></ol>
            
                </p>
            
                <p>
                    If robot-voice is selected; then Translator.js will use meSpeak.js library; which will be loaded and played using web-worker.
                </p>
            </section>
        
            <section class="experiment">
                <h2 class="header" id="how">How to test?</h2>
                <ol>
                    <li>
                        Make sure that you're using Microphone instead of notebook's built-in audio input device or webcam's audio input device.
                    </li>
                    
                    <li>
                        Open same URL/webpage on two computers or devices; choose language in which incoming voice will be translated; then select "robot-voice" to prefer using meSpeak.js robot; otherwise, Translator.js will use Google's Translation API to play the voice.
                    </li>
                </ol>
            </section>
            
            <section class="experiment">
                <h2 class="header" id="how">Disclaimer</h2>
                <p>
                    This demo will not work in your custom domains until you buy an API-key from Google API console. Actually, Google Translate API is a paid service, and this demo is using Google Translate API to convert text from one language to another.
                </p>
            </section>

            <script>
                var startSpeaking = document.getElementById('start-speaking');

                startSpeaking.onclick = function() {
                    this.disabled = true;

                    log('Your language is ', yourLanguage.value.split(' (')[0]);

                    translator.voiceToText(function(text) {
                        firebase.push({
                            text: text,
                            language: yourLanguage.value.split(' (')[0]
                        });
                    }, yourLanguage.value.split(' (')[0]);
                };

                var translator = new Translator();

                var firebase = new Firebase('//webrtc.firebaseio.com/' + location.href.replace( /\/|:|#|%|\.|\[|\]/g , ''));

                firebase.on('child_added', function(snap) {
                    var data = snap.val();

                    log('original language: ' + data.language);
                    log('original text: ' + data.text);
                    log('converting into: ' + yourLanguage.value.split(' (')[0]);

                    translator.translateLanguage(data.text, {
                        from: data.language,
                        to: yourLanguage.value.split(' (')[0],
                        callback: function(translatedText) {
                            log('translated text: ' + translatedText);

                            if (robotVoice.checked) {
                                log('Using robot to speak text.');
                                translator.speakTextUsingRobot(translatedText, {
                                    // please download and link worker file on your own domain
                                    workerPath: 'https://cdn.webrtc-experiment.com/Robot-Speaker.js',
									onWorkerFileDownloadStart: function() {
										log('Downloading worker file. It is about 2MB in size.');
									},
									onWorkerFileDownloadEnd: function() {
										log('Worker file is downloaded.');
									}
                                });
                            } else {
                                log('Using Google Translate API to speak text.');
                                translator.speakTextUsingGoogleSpeaker({
                                    textToSpeak: translatedText,
                                    targetLanguage: yourLanguage.value.split(' (')[0],

                                    // please use your own API key; if possible
                                    api_key: 'AIzaSyCgB5hmFY74WYB-EoWkhr9cAGr6TiTHrEE'
                                });
                            }
                        }
                    });
                    snap.ref().remove();
                });

                firebase.onDisconnect().remove();

                var yourLanguage = document.getElementById('your-language');
                var robotVoice = document.getElementById('robot-voice');
                var logs = document.getElementById('logs');

                function log() {
                    var li = document.createElement('li');
                    li.innerHTML = JSON.stringify(arguments);
                    logs.appendChild(li);
                    li.tabIndex = 0;
                    li.focus();
                }
                
                // just to generate random room-id
                (function() {
                    var uniqueToken = document.getElementById('unique-token');
                    if (uniqueToken)
                        if (location.hash.length > 2) uniqueToken.parentNode.parentNode.parentNode.innerHTML = 'Your room seeems private. Plese open <a href="' + location.href + '" target="_blank">same URL</a> in another tab/window.';
                        else uniqueToken.innerHTML = uniqueToken.parentNode.parentNode.href = '#' + (Math.random() * new Date().getTime()).toString(36).toUpperCase().replace(/\./g, '-');
                })();
            </script>

            <br />
            <br />
            
            <section class="experiment">
                <h2 class="header">
                    How to use <a href="https://github.com/muaz-khan/WebRTC-Experiment/tree/master/Translator.js" target="_blank">Translator.js</a>?</h2>
                <pre class="sh_html">
&lt;script src="//cdn.WebRTC-Experiment.com/Translator.js"&gt;&lt;/script&gt;
</pre>
            </section>
            <section class="experiment">
                <pre class="sh_javascript">
// constructor
var translator = new Translator();

// voiceToText method allows you convert voice to text; 
// whatever you speak is recognized using Google 
// Speech-Recognition API; and converted into 
// text using same API:
translator.voiceToText(function (text) {
    console.log('Your voice as text!', text);
}, 'en-US');

// translateLanguage method allows you convert language. 
// You just need to pass text and get translated text 
// through callback parameter:
translator.translateLanguage(textToConvert, {
    from: 'language-of-the-text',
    to: 'convert-into',
    callback: function (translatedText) {
        console.log('translated text', translatedText);
    }
});

// speakTextUsingRobot method uses meSpeak.js library 
// to play text using a robot voice. Behind the scene; 
// text is buffered and converted into WAV file; 
// which is played using invisible &lt;audio&gt; element.
translator.speakTextUsingRobot(textToPlay, {
    workerPath: '//cdn.webrtc-experiment.com/Robot-Speaker.js',
    callback: function (WAV_File) {},
    amplitude: 100,
    wordgap: 0,
    pitch: 50,
    speed: 175,
    onSpeakingEnd: function() {},
    onWorkerFileDownloadStart: function() {},
    onWorkerFileDownloadEnd: function() {}
});

// If you want to play WAV file yourself or you want to 
// POST/store WAV file; then you can use callback 
// parameter to override default behaviour:
translator.speakTextUsingRobot(textToPlay, {
    callback: function (WAV_File) {
        HTTP_POST_using_FormData( WAV_File );
    }
});

// speakTextUsingGoogleSpeaker method uses Google's Non-Official 
// Translation API to convert text into mp3 sound. API Key 
// used is taken from someone on the web; and there is 
// no guarantee of its availability; that's why it is 
// strongly suggested to buy your own KEY and pass using 
// api_key parameter:
translator.speakTextUsingGoogleSpeaker({
    textToSpeak: 'text-to-convert',
    targetLanguage: 'your-language',

    // Google Translation service's API Key
    // You can buy it from Google API console
    api_key: 'Your-Private-API-Key'
});
</pre>                
            </section>
            
            <section style="border: 1px solid rgb(189, 189, 189); border-radius: .2em; margin: 1em 3em;">
                <h2 id="feedback" style="border-bottom: 1px solid rgb(189, 189, 189); padding: .2em .4em;">Want to ask a Question?</h2>
                <div>
                    <textarea id="message" style="border: 1px solid rgb(189, 189, 189); height: 8em; margin: .2em; outline: none; resize: vertical; width: 98%;" placeholder="Feel free to ask any question regarding Translator.js or WebRTC!"></textarea>
                </div>
                <button id="send-message" style="font-size: 1em;">Ask a Question</button><small style="margin-left: 1em;">You can include your email for private conversation!</small>
            </section>
            
            <section class="experiment own-widgets latest-commits">
                <h2 class="header" id="updates" style="color: red; padding-bottom: .1em;"><a href="https://github.com/muaz-khan/WebRTC-Experiment/commits/master" target="_blank">Latest Updates</a></h2>
                <div id="github-commits"></div>
            </section>

        </article>
        
        <a href="https://github.com/muaz-khan/WebRTC-Experiment/tree/master/Translator.js" class="fork-left"></a>

        <footer>
            <p>
                <a href="https://www.webrtc-experiment.com/">WebRTC Experiments</a>
                © <a href="https://plus.google.com/+MuazKhan" rel="author" target="_blank">Muaz Khan</a>
                <a href="mailto:muazkh@gmail.com" target="_blank">muazkh@gmail.com</a>
            </p>
        </footer>
    
        <!-- commits.js is useless for you! -->
        <script src="//cdn.webrtc-experiment.com/commits.js" async> </script>
    </body>

</html>
