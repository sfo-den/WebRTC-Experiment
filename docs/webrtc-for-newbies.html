<!-- Muaz Khan ( @muazkh ) : github.com/muaz-khan -->
<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta itemprop="image" content="https://muazkh.appspot.com/images/WebRTC.png">
    <title>WebRTC for newbies! ® Muaz Khan</title>
    <meta name="description" content="A conceptual documentation for newbies who are interested to getting started with WebRTC from beginning! It explains A-to-Z all basic parts of RTCWeb APIs!">
    <link rel="author" type="text/html" href="https://plus.google.com/100325991024054712503">
    <meta name="author" content="Muaz Khan">
    <meta name="copyright" content="© Muaz Khan, 2013">
    <style>
        @font-face
        {
            font-family: 'Open Sans';
            font-style: normal;
            font-weight: 300;
            src: local('Open Sans Light'), local('OpenSans-Light'), url(/images/font.woff) format('woff');
        }
        *
        {
            margin: 0;
            padding: 0;
            font-family: 'Open Sans';
            -moz-transition: all .8s ease;
            -ms-transition: all .8s ease;
            -o-transition: all .8s ease;
            -webkit-transition: all .8s ease;
        }
        html
        {
            background: #ECECEC;
            overflow-x: hidden;
        }
        
        body
        {
            color: #333;
            font: 1.4em 'Open Sans' , arial, sans-serif;
            font-weight: 300;
            line-height: 1.5;
            margin: 0 3em;
            background: white;
            border: 1px dotted #BBA9A9;
            border-top: 0;
        }
        
        h1, h2
        {
            color: #2778ec;
            font-size: 1.6em;
            font-weight: 300;
            line-height: 1.15;
        }
        
        .logo img
        {
            border-radius: 50%;
            box-shadow: 0 0 5px black, 0 0 5px black, 0 0 5px black, 0 0 5px black, 0 0 5px black;
        }
        
        blockquote
        {
            margin-bottom: 1em;
        }
        tr, td, th
        {
            vertical-align: top;
            padding: .7em 1.4em;
            border-top: 1px dotted #BBA9A9;
            border-right: 1px dotted #BBA9A9;
        }
        
        @media screen and (max-width: 770px)
        {
            body
            {
                margin: 0 .1em;
                font-size: 1em;
            }
            tr, td
            {
                padding: .1em .4em;
            }
        }
        
        a
        {
            display: inline-block;
            padding: 0.2em;
            color: #1B75C9;
            text-decoration: none;
            border-bottom: 1px dotted #0085FF;
            margin: 0 .2em;
        }
        a.logo
        {
            background: url(/images/right-arrow.gif) no-repeat left center;
            padding-left: 1.5em;
        }
        a:hover
        {
            color: red;
        }
        footer
        {
            text-align: center;
        }
        .g-plusone
        {
            position: static;
        }
        .plusone-gplus
        {
            top: 4.2em;
            margin-left: -1.7em;
            position: absolute;
        }
        .fork-webrtc-experiment
        {
            border: 0;
            outline: 0;
            display: inline;
        }
        .fork-webrtc-experiment img
        {
            position: absolute;
            right: 3em;
        }
        .log
        {
            position: absolute;
            right: 7em;
            left: 3.1em;
            padding: .2em 1em;
            background: rgba(255, 255, 255, 0.87);
            border-bottom: 1px dotted #BBA9A9;
            color: red;
            display: none;
        }
        details
        {
            position: absolute;
            z-index: 1000;
            background: white;
            cursor: pointer;
            border-right: 1px dotted #BBA9A9;
            border-bottom: 1px dotted #BBA9A9;
        }
        details:hover
        {
            color: red;
        }
        summary
        {
            padding: 0 .4em;
            -webkit-user-select: none;
        }
        details a
        {
            display: block;
        }
        .contact
        {
            position: absolute;
            right: 8em;
            border: 0;
            color: red;
        }
        .contact:hover
        {
            color: #BD0707;
        }
        dl
        {
            max-height: 0;
            overflow: hidden;
        }
        summary
        {
            display: block;
        }
        dt
        {
            border-top: 1px dotted #BBA9A9;
            padding: .5em 1em;
        }
        dt a
        {
            border: 0;
            padding: 0;
            margin: 0;
        }
        
        strong
        {
            font-weight: inherit;
            color: red;
        }
        ol
        {
            margin-left: 3em;
        }
        code, pre, pre strong, code strong
        {
            font-family: Consolas, "Andale Mono" , "Lucida Console" , "Courier New" , monospace;
        }
        .comment
        {
            color: #0E59DD;
            font-family: inherit;
        }
        
        /* feedback / contact */
        a.send-message
        {
            background: url(/images/accept.gif) no-repeat left center;
            padding-left: 1.5em;
            display: inline-block;
            border: 1px solid #9CA2A8;
            margin-left: 0;
        }
        
        textarea
        {
            font-size: 1.2em;
            padding: .2em;
            width: 95%;
            outline: none;
            height: 4em;
            resize: vertical;
            -webkit-transition: none;
        }
        
        .contact-panel h2, .contact-panel div
        {
            border-bottom: 1px double #CACACA;
            margin-bottom: .5em;
            padding: .2em;
        }
        
        .send-message
        {
            display: block;
        }
    </style>
</head>
<body>
    <div id="pubnub" ssl="on">
    </div>
    <script src="https://bit.ly/socket-io"></script>
    <a href="https://github.com/muaz-khan/WebRTC-Experiment" class="fork-webrtc-experiment"
        target="_blank">
        <img src="/images/fork-webrtc-experiment.png" alt="Fork WebRTC Experiment"></a>
    <a href="/issues-messages-requests-feedback-contact/" class="contact" title="Bugs/Errors/Issues, Requests/Suggestions/Feedbacks, and Contact!">
        Have any message for Muaz Khan?</a>
    <details>
            <summary>Other WebRTC Experiments</summary>
            <dl>
                <dt>
                    <a href="/video-conferencing/">Video-Conferencing / Hangout!</a>
                </dt>
                <dt>
                    <a href="/file-broadcast/">P2P File Sharing using RTCDataChannel APIs</a>
                </dt>
                <dt>
                    <a href="/chat/" title="Chat using RTCDataChannel APIs">RTCDataChannel APIs and TEXT Broadcast: Chat</a>
                </dt>
                <dt>
                    <a href="/screen-broadcast/">WebRTC Screen Broadcasting!</a>
                </dt>
                <dt>
                    <a href="/broadcast/">WebRTC Video (+Audio) Broadcasting!</a>
                </dt>
                <dt>
                    <a href="/audio-broadcast/">WebRTC Audio Broadcasting!</a>
                </dt>
                <dt>
                    <a href="/docs/how-to-use-rtcpeerconnection-js-v1.1.html" style="display: inline;">How to use RTCPeerConnection? A simple Guide</a>
                </dt>
                <dt>
                    <a href="/" style="display: inline;">Home</a> / <a href="/calls/" style="display:inline;">Plugin-free calls: Browser to Browser</a>
                </dt>
                <dt>
                    <a href="/websocket/" style="display: inline;">WebSocket!</a> / <a href="/socket.io/" style="display: inline;">Socket.io!</a> / <a href="/aspnet-mvc/" style="display: inline;">XHR and ASP.NET MVC!</a>
                </dt>
                <dt>
                    Client Side: <a href="/demos/client-side.html" style="display: inline;">Simple</a> / <a href="/demos/client-side-websocket.html" style="display: inline;">WebSocket</a> / <a href="/demos/client-side-socket-io.html" style="display: inline;">Socket.io</a>
                </dt>
            </dl>
        </details>
    <table>
        <tr>
            <td>
                <br />
                <a class="logo" href="https://plus.google.com/100325991024054712503">
                    <img src="/images/Muaz-Khan.gif" width="100" height="100">
                </a>
                <br />
            </td>
            <td>
                <br />
                <h1>
                    WebRTC for newbies!</h1>
                <blockquote class="slogan">
                    A conceptual documentation for newbies who are interested to getting started with
                    WebRTC from beginning! It explains A-to-Z all "basic" parts of RTCWeb APIs!
                </blockquote>
                <a href="/docs/webrtc-for-beginners.html">WebRTC for Beginners!</a>
                » <a href="/docs/how-to-use-rtcpeerconnection-js-v1.1.html">How to use RTCPeerConnection.js?</a>
                » <a href="/docs/how-to-use-rtcdatachannel.html">RTCDataChannel?</a>
            </td>
        </tr>
    </table>
    
    <table>
        <tr>
            <td>
                It is assumed that the reader has no knowledge of WebRTC basic concepts.
            </td>
        </tr>
        <tr>
            <td>
                This document explains "what you need to understand (the prerequisites) for a simple WebRTC application".
            </td>
        </tr>
        
        <tr>
            <td>
                <h2>
                    Any installations needed on server....for a simple WebRTC app?
                </h2>
            </td>
        </tr>
        
        <tr>
            <td>
                Not at all! You JUST need to understand the basics of JavaScript. A web server (website) is needed to upload your HTML file. You can use jsFiddle instead! ... And that's all you need to do!
            </td>
        </tr>
        
        <tr>
            <td>
                <h2>
                    Signaling and the handshake!
                </h2>
            </td>
        </tr>
        
        <tr>
            <td>
                <img src="https://sites.google.com/site/muazkh/how-webrtc-offer-answer-model-works.png" alt="How offer/answer model works in WebRTC?">
            </td>
        </tr>
        
        <tr>
            <td>
                Signaling is a process in which SDP/ICE is passed between peers/participants.
            </td>
        </tr>
        
        <tr>
            <td>
                If userA generates SDP (Session Description Protocol); you should pass it to userB. You can use XMLHttpRequest, WebSocket, WebSync, or many other solutions.
            </td>
        </tr>
        
        <tr>
            <td>
                Since last two decades; offer/answer model is used for initial handshake among many well-known media frameworks. This method is also used for WebRTC initial implementation.
            </td>
        </tr>
        
        <tr>
            <td>
                <h2>
                    What is offer/answer model? (in simple words)
                </h2>
            </td>
        </tr>
        
        <tr>
            <td>
                Assume a person, who asks his friend to join and talk with him, creates an offer for his friend. His friend receives offer and sends back him the answer. Now, that person "the offerer" gets answer and if answer is positive; completes the handshake!
            </td>
        </tr>
        
        <tr>
            <td>
                <h2>
                    Here is a simple SDP generated by Google Chrome
                </h2>
            </td>
        </tr>
        
        <tr>
            <td>
                <pre>
a=group:BUNDLE <strong title="audio stream – microphone">audio</strong> <strong title="video stream – webcam">video</strong> <strong title="RTCDataChannel – files, images, text, any kind of data!">data</strong>
...
a=rtpmap:103 <strong title="ISAC">ISAC</strong>/16000
a=rtpmap:111 <strong title="opus audio codec">opus</strong>/48000
a=rtpmap:0 <strong title="PCMU">PCMU</strong>/8000
...
a=rtpmap:100 <strong title="VP8">VP8</strong>/90000
...
</pre>
            </td>
        </tr>
        
        <tr>
            <td>
                A simple SDP can contain:
            </td>
        </tr>
        
        <tr>
            <td>
                <ol>
                    <li>
                        codec negotiation and selection (audio[opus, PCMU, iLBC], video[VP8, H261], etc.)
                    </li>
                    <li>
                        hold and resume [<code>a=<strong>sendrecv</strong></code>]
                    </li>
                    <li>
                        addition and deletion of media streams
                    </li>
                </ol>
            </td>
        </tr>
        
        <tr>
            <td>
                In simple words, SDP can contain audio/video codecs, protocols and ip address; also cryptographic data like passwords and other relevant info required for media stream flow.
            </td>
        </tr>
        
        <tr>
            <td>
                If SDP is created by "offerer", you should use XHR/WebSocket method to send it to other end/peer/user/friend.
            </td>
        </tr>
        
        <tr>
            <td>
                Your friend (target-user/participant) will get "offer sdp", set his remote and local configuration and create "answer sdp" that you need to pass back toward the "offerer". So offerer can set his remote configuration using "answer sdp" and complete the handshake.
            </td>
        </tr>
        
        <tr>
            <td>
                <h2>
                    Here is the step-by-step process:
                </h2>
            </td>
        </tr>
        
        <tr>
            <td>
                <ol>
                    <li>
                        Offerer creates offer sdp
                        
                        <blockquote>
                            Offerer can be a person who creates the room or makes an offer to his friend to join him
                        </blockquote>
                        
                        <blockquote>
                            Now, you'll use XHR/WebSocket/WebSync method to transfer "Offer SDP" --- the "text message" on the other side! (On the answerer side)
                        </blockquote>
                    </li>
                    
                    <li>
                        Answerer gets "offer sdp" and sets his remote descriptions/configurations using that "offer sdp"
                        
                        <blockquote>
                            Answerer can be a person who joins the room or receives an offer. His first step is set his remote descriptions/configurations.
                        </blockquote>
                    </li>
                    
                    <li>
                        Answerer creates "answer sdp" and sets his local descriptions/configurations
                        
                        <blockquote>
                            Now, you'll use XHR/WebSocket/WebSync method to transfer "Answer SDP" --- the "text message" on the other side! (On the offerer side)
                        </blockquote>
                    </li>
                    
                    <li>
                        Offerer gets "answer sdp" and sets his remote descriptions/configurations using that "answer sdp" --- and completes the handshake!
                    </li>
                </ol>
            </td>
        </tr>
        
        <tr>
            <td>
                <h2>Where to put ICE?</h2>
            </td>
        </tr>
        
        <tr>
            <td>
                ICE is something that starts generating as soon as you initialize the peer connection object. Unlike SDP (which is generated by user-agent/browser), it is generated by STUN/TURN server.
            </td>
        </tr>
        
        <tr>
            <td>
                It is recommended to pass all ICE generated by/for local peer on the other side. However, add ICE candidates until remote stream starts flowing.
            </td>
        </tr>
        
        <tr>
            <td>
                Suppose that offer sent 12 ICE for answerer. The peer object on the answerer side will try to find/get most suitable ICE candidate to complete the handshake. Remember, it uses only one ICE that is most appropriate for better stream flowing.
            </td>
        </tr>
        
        <tr>
            <td>
                On the answerer side, don't add ICE sent by offerer until answerer generates "answer sdp". 
            </td>
        </tr>

        <tr>
            <td>
                You can use <code>peerConnection.<strong>onicecandidate</strong></code> event to get ICE generated for local peer. You can send those ICE via XHR/WebSocket/WebSync on the other side.
            </td>
        </tr>
        
        <tr>
            <td>
                <code>peerConnection.<strong>onaddstream</strong></code> fires as soon as local peer gets clue of the remote stream. Remember, it takes a few seconds for remote stream to start flowing. You can check whether remote stream started flowing or not using something like this:
            </td>
        </tr>
        
        <tr>
            <td>
                <pre>
video = event.<strong>stream</strong>; // if chrome: webkitURL.createObjectURL( event.stream )
if (!(video.<strong>readyState</strong> &lt;= HTMLMediaElement.<strong>HAVE_CURRENT_DATA</strong> 
                        || video.<strong>paused</strong> 
                        || video.<strong>currentTime</strong> &lt;= 0)) 
{ 
    ....
}
</pre>
            </td>
        </tr>
        
        <!--
        <tr>
            <td>
                <h2>How stream flows?</h2>
            </td>
        </tr>
        
        <tr>
            <td>
                <img src="http://goo.gl/gJ6Vf" alt="WebRTC Architecture">
            </td>
        </tr>
		
		<tr>
			<td>
				WebRTC offers web application developers the ability to write rich, realtime multimedia applications (think video chat) on the web, without requiring plugins, downloads or installs. It's purpose is to help build a strong RTC platform that works across multiple web browsers, across multiple platforms.
			</td>
		</td>
		
		-->
        
        <tr>
            <td>
                This document needs to be reviewed and a little bit more additions. It will be updated soon.
            </td>
        </tr>		
    </table>
    
    <table style="width: 100%;">
        <tr>
            <td>
                <blockquote>
                    <div>
                        <textarea id="message" placeholder="Something went wrong? Need any help?"></textarea>
                    </div>
                    <a id="send-message" class="send-message" href="#send-message">Send Message to Muaz
                        Khan</a>
                </blockquote>
            </td>
        </tr>
    </table>
    <section class="plusone-gplus">
    <div class="g-plusone"></div>
</section>
    <footer>
    <a href="/">Home</a>
    © <a href="https://plus.google.com/100325991024054712503" rel="author">Muaz Khan</a>, 2013
    » <a href="mailto:muazkh@gmail.com">Email</a>
    » <a href="http://twitter.com/muazkh">@muazkh</a>
    » <a href="https://github.com/muaz-khan">Github</a>
    » <a href="https://plus.google.com/106306286430656356034/posts">Google+</a>
</footer>
    <script src="/dependencies/common.js"></script>
</body>
</html>